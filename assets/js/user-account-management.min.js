!function(){"use strict";function d(){var e,s,a,t,n;document.querySelector(".password-strength-check")&&(e=document.querySelector(".a-form-show-password"),s=document.createElement("meter"),n=document.createElement("div"),a=document.createElement("p"),t=document.querySelector(".register-button"),s.setAttribute("max","4"),s.setAttribute("id","password-strength"),a.setAttribute("id","password-strength-text"),s.appendChild(n),e.after(s),e.after(a),0<(n=document.querySelectorAll("input[name=password], input[name=new_password]")).length&&t&&n.forEach(function(e){e.addEventListener("keyup",function(e){var e=e.target.value,t=s,n=a,r=["disallowed","listed","word"];switch(n.classList.remove("short","bad","good","strong"),r=r.concat(wp.passwordStrength.userInputDisallowedList()),r=wp.passwordStrength.meter(e,r,e)){case 2:n.classList.add("bad"),n.innerHTML="Strength: <strong>"+pwsL10n.bad+"</strong>";break;case 3:n.classList.add("good"),n.innerHTML="Strength: <strong>"+pwsL10n.good+"</strong>";break;case 4:n.classList.add("strong"),n.innerHTML="Strength: <strong>"+pwsL10n.strong+"</strong>";break;case 5:n.classList.add("short"),n.innerHTML="Strength: <strong>"+pwsL10n.mismatch+"</strong>";break;default:n.classList.add("short"),n.innerHTML="Strength: <strong>"+pwsL10n.short+"</strong>"}t.setAttribute("value",r)})}))}function l(t){var e,n,r,s,a,o,c,u,i,d=document.querySelector(".m-form-country #country");d&&(void 0===t&&(t=!1),0<(n=d.querySelectorAll("select","input")).length&&n.forEach(function(e){e.classList.contains("not-in-us")||(t=!0)}),(n=document.querySelector(".m-form-zip-code"))&&(d=d,r=t,s=(n=n).querySelector("#zip-code"),a=n.querySelector("label"),o=document.createElement("div"),c=document.createElement("small"),u=document.createElement("div"),i=d.value,o.setAttribute("class","a-form-caption location"),o.innerHTML="<small></small>",n.append(o),u.setAttribute("class","a-form-caption show-country"),o=s,a=a,""===(e=i)||"US"===e?(o.setAttribute("type","tel"),a.innerHTML='Zip Code: <span title="This field is required." class="a-form-item-required">*</span>'):(o.setAttribute("type","text"),a.innerHTML='Postal Code: <span title="This field is required." class="a-form-item-required">*</span>'),!1!==r||""!==i&&"US"!==i?d.parentNode.style.display="block":(d.parentNode.style.display="none",s.innerHTML=c,u.innerHTML='<a href="#" id="registration_show_country"><small>Not in the US?</small></a>',n.append(u))))}function m(n,r,e,t){var s,a=t.value,t=(""===a&&(a="US",t.value=a),e.value);""!==t&&(e={zip_code:t,country:a},(s=document.querySelector(".location small"))&&(t=user_account_management_rest.site_url+user_account_management_rest.rest_namespace+"/check-zip",t+="?"+new URLSearchParams(e).toString(),fetch(t).then(function(e){return e.json()}).then(function(e){var t;"success"===e.status?(t="",t+=e.city,n&&(n.value=e.city),e.city!==e.state&&(t+=", "+e.state,r&&(r.value=e.state)),"US"!==a&&(t+=", "+a),s.innerHTML=t):s.innerHTML=""}).catch(function(){s.innerHTML=""})))}document.addEventListener("DOMContentLoaded",function(){var n,e,r,s,t,a,o,c,u,i;e=user_account_management_rest.site_url+user_account_management_rest.rest_namespace,r=document.querySelector("#email"),a=document.querySelector(".register-button"),r&&a&&r.addEventListener("keyup",function(e){var t=e.currentTarget.value;clearTimeout(n),n=setTimeout(function(){s(t)},500)}),s=function(t){fetch(e+"/check-account/?email="+t,{method:"GET"}).then(function(e){return e.json()}).then(function(e){"success"===e.status&&"user exists"===e.reason&&((e=document.createElement("div")).innerHTML='<p class="a-form-caption a-account-exists a-account-exists-success">This email address already has a MinnPost.com account. You can <a href="'+user_account_management_rest.site_url+"/user/login/?email="+t+'">log in</a> or <a href="'+user_account_management_rest.site_url+"/user/password-lost/?email="+t+'">reset your password</a>.</p>',r.after(e))})},(t=document.querySelector(".password-show"))&&((a=document.createElement("div")).innerHTML='<div class="a-form-show-password a-form-caption"><label><input type="checkbox" name="show_password" id="show-password-checkbox" value="1"> Show password</label></div>',t.after(a),(a=document.querySelector("#show-password-checkbox"))&&a.addEventListener("click",function(){!0===event.currentTarget.checked?t.setAttribute("type","text"):t.setAttribute("type","password")})),d(),l(),(a=document.querySelector("#registration_show_country"))&&a.addEventListener("click",function(e){e.preventDefault(),e.target.style.display="none",l(!0)}),o=document.querySelector('input[name="city"]'),c=document.querySelector('input[name="state"]'),u=document.querySelector("#zip-code"),i=document.querySelector(".m-form-country #country"),u&&u.addEventListener("blur",function(){m(o,c,u,i)}),i&&i.addEventListener("change",function(){m(o,c,u,i)})})}();